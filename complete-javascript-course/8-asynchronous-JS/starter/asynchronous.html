<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Asynchronous JavaScript</title>
</head>
<body>
    <h1>Asynchronous JavaScript</h1>
    <script>
        //making a callback function for when a function is done processing is Asynchronous code (using callback functions to defer actions into the future)
        //  we dont wait for the function to finish to do something with the result
        // Asynchronous code - non-blocking

        /*
        * Web API's live outside of the js engine
        * things like: setTimeout, DOM manipulation methods, requests for ajax, geolocation, local storage... etc
        *
        * we have access to web api's bc they're in js runtime
        *
        * ex: setTimeout gets called into the callstack but pops off to wait in web api (works same for dom events, like event listeners)
        *
        * when finished move to message queue where it waits to be executed as soon as the call stack is empty
        *
        * the job of the event loop is to constantly monitor the message queue and the call stack and to push the first callback function to the call stack as soon as it is empty
        *
        *
        * PROMISES:
        * an obj that keeps track of whether a certain event has happened or not
        *
        * determines what happens AFTER the event happened
        *
        * implements the concept of a future value that we're expecting
        *
        * a promise is an obj that you can then attach callbacks to do something with the data
        *
        * .fetch .json return promises
        *
        * use then methods to handle promises to ensure data is already returned
        *
        * a  bunch of chained .then are all returned and need to be retunred (the single line shorthand with arrow function return is implied)
        * in a chain of .then the bottom .catch with run at any point in the the .then if something goes wrong
        *
        * API a piece of software that can be used by another piece of sofware to communicate to one another
        *
        * CORS cross origin resource sharing. an API needs to develop this on thier server to allow resource sharing
        *
        * u can proxy a request thru ur own server. like doing an ajax request on our own server (where the same origin policy doesnt exit) and then send the data to the browser
        * */
        /*
        function getRecipe() {
            setTimeout(() => {
                const recipeID = [523, 883, 432, 974];
                console.log(recipeID);

                setTimeout(id => {
                    const recipe = {title: 'Fresh tomato pasta', publisher: 'Jonas'};
                    console.log(`${id}: ${recipe.title}`);

                    setTimeout(publisher => {
                        const recipe2 = {title: 'Italian Pizza', publisher: 'Jonas'};
                        console.log(recipe);
                    }, 1500, recipe.publisher); //passing publisher param as argument here after time

                }, 1500, recipeID[2]);

            }, 1500);
        }
        getRecipe();
         */

        // const getIDS = new Promise((resolve, reject) => {
        //     setTimeout(() =>{
        //         resolve([523, 883, 432, 974]); //want to return this data
        //     }, 1500)
        // });
        //
        //
        // // then is the callback to execute when the Promise is resolved
        // getIDS
        // .then(IDs => { //has the result of the successful promise (resolve)
        //     console.log(IDs)
        // })
        // .catch(error => { //has result of unsuccessful promise (reject)
        //     console.log(error)
        // });


        // AWAIT can only be used in ASYNC function
        // AWAIT returns a promise
        // always use .then to execute things after promise is finished processing
        // ASYNC functions runs asynchronously in the background
        // async function getRecipesAW() {
        //     const IDs = await getIDs; //storing the result of successful getIDs promise into IDs var
        //     console.log(IDs);
        //     const recipe = await getRecipe(IDs[2]);
        //     console.log(recipe);
        //     const related = await getRelated('Jonas Schmedtmann');
        //     console.log(related);

        //     return recipe;
        // }


        String.prototype.repeatify = String.prototype.repeatify || function(times)  {
            var str = '';
            // console.log(this)

            for (var i = 0; i < times; i++) {
                console.log(this)
                str += this;
            }

            return str;
        };
        console.log('hello'.repeatify(3));

    </script>
</body>
</html>